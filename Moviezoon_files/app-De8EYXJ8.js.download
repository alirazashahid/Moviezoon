define(["OK/CurrentUserCfg","OK/logger","OK/GwtConfig","OK/utils/utils","jquery","OK/AjaxNavigationLog","OK/utils/screens"],function(H,R,se,de,ge,ye,he){var r={};"use strict";function Y(e){if(e&&e.__esModule)return e;var n=Object.create(null);if(e){Object.keys(e).forEach(function(t){if(t!=="default"){var a=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,a.get?a:{enumerable:true,get:function get(){return e[t]}})}})}n.default=e;return n}var $=Y(R);var W=Object.defineProperty;var X=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var d=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty;var ee=Object.prototype.propertyIsEnumerable;var g=function(e,n,t){return n in e?W(e,n,{enumerable:true,configurable:true,writable:true,value:t}):e[n]=t};var y=function(e,n){for(var t in n||(n={}))if(x.call(n,t))g(e,t,n[t]);var _iteratorNormalCompletion=true,_didIteratorError=false,_iteratorError=undefined;if(d)try{for(var _iterator=d(n)[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var t=_step.value;if(ee.call(n,t))g(e,t,n[t])}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return e};var ne=function(e,n){return X(e,Z(n))};var re="music/bootstrap";var te=2500;function c(){return u().then(function(e){return e.loadModel()})}function u(){oe();return new Promise(function(e,n){window.require([re],function(t){ce(t);e(t)},n)})}function h(e){window.require(["OK/pts!music.app"]);return u().then(function(n){return n.mountLayer(e,{id:"music_layer"})})}function P(e){window.require(["OK/pts!music.app"]);return u().then(function(n){return n.mountMiniPLayer(e)})}function m(e){window.require(["OK/pts!music.app"]);return u().then(function(n){return n.mountMusicPicker(e)})}function k(e){return u().then(function(n){return n.unmountMusicPicker(e)})}var o=false;var i=null;var ue=null;function p(){return o}function O(){return i}function v(){return ue}function _(){if(i==null?void 0:i.track){return ne(y({},i==null?void 0:i.track),{playing:o})}}function T(){return u().then(function(e){return e.togglePlaying()})}function w(){return u().then(function(e){return e.seekForward()})}function C(){return u().then(function(e){return e.seekBackward()})}function b(){return u().then(function(e){return e.louder()})}function M(){return u().then(function(e){return e.quieter()})}function j(){return u().then(function(e){return e.nextTrack()})}function A(){return u().then(function(e){return e.prevTrack()})}function I(){return u().then(function(e){return e.pause()})}function q(e,n){return u().then(function(t){return t.play(e,n)})}function L(e){return u().then(function(n){return n.addPlaylist(e)})}function S(e){return u().then(function(n){return n.removePlaylist(e)})}function K(e,n){return u().then(function(t){return t.addTrack(e,n)})}function N(e){return u().then(function(n){return n.removeTrack(e)})}function E(e,n,t){return u().then(function(a){return a.playQueue(e,n,t)})}function Q(){return u().then(function(e){return e.loadMyTracks()})}function B(e){return u().then(function(n){return n.searchTracks(e)})}function D(e,n,t){return u().then(function(a){return a.share(e,n,t)})}var l=new Set;function f(e,n){l.add(n)}function s(e,n){l.delete(n)}function J(e,n){var t=function(a){s(e,t);U(n,a)};f(e,t)}function ae(e){l.forEach(function(n){return U(n,e)})}function U(e,n){try{if(ie(e)){e.handleTrackChange(n)}else{e(n)}}catch(t){$.clob("music.app.error",t.stack,"notify",n)}}function ie(e){return e.hasOwnProperty("handleTrackChange")||Object.getPrototypeOf(e).hasOwnProperty("handleTrackChange")}var F=false;var G=true;function ce(e){if(F){return}F=true;e.onPlayItemChanged(function(n){o=n.playing;i=y({},n)});e.onTrackChanged(function(n){if(G){G=false;return}ae(n)})}function oe(){if(!(OK==null?void 0:OK.musicConfiguration)){OK.musicConfiguration=le()}}function le(){var e=document.getElementById("music_layer_holder");var n=H.CurrentUserCfg.getInstance().getUserId();if(e){return{uid:n,conf:JSON.parse(e.getAttribute("data-conf")),confJson:e.getAttribute("data-conf-json"),tooltips:JSON.parse(e.getAttribute("data-tooltips"))}}return{uid:n,conf:{},confJson:""}}var V=true;var z=true;var fe={activate:c,loadMusicApp:u,mountLayer:h,mountMiniPlayer:P,mountMusicPicker:m,unmountMusicPicker:k,playing:p,getCurrentPlayItem:O,getCurrentQueue:v,getCurrentTrack:_,togglePlaying:T,seekForward:w,seekBackward:C,louder:b,quieter:M,nextTrack:j,prevTrack:A,pause:I,play:q,addPlaylist:L,removePlaylist:S,addTrack:K,removeTrack:N,playQueue:E,loadMyTracks:Q,searchTracks:B,share:D,on:f,off:s,once:J,v2:V,v3:z};setTimeout(c,te);r.activate=c;r.addPlaylist=L;r.addTrack=K;r.default=fe;r.getCurrentPlayItem=O;r.getCurrentQueue=v;r.getCurrentTrack=_;r.loadMusicApp=u;r.loadMyTracks=Q;r.louder=b;r.mountLayer=h;r.mountMiniPlayer=P;r.mountMusicPicker=m;r.nextTrack=j;r.off=s;r.on=f;r.once=J;r.pause=I;r.play=q;r.playQueue=E;r.playing=p;r.prevTrack=A;r.quieter=M;r.removePlaylist=S;r.removeTrack=N;r.searchTracks=B;r.seekBackward=C;r.seekForward=w;r.share=D;r.togglePlaying=T;r.unmountMusicPicker=k;r.v2=V;r.v3=z;Object.defineProperty(r,"__esModule",{value:true});return r});