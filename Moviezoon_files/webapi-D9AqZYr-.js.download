define(["OK/utils/vanilla","OK/logger","OK/AjaxNavigationLog","OK/utils/screens"],function(w,m,k,x){var s={};"use strict";function y(e){return e&&e.__esModule?e:{default:e}}var p=y(m);var E="/web-api/v2/";var _=0;var o=false;var f="api.communication-error";function R(){return++_}function T(e){return E+e}function O(e){return JSON.stringify(e,null,2)}function A(e,n,r){var a=T(e);var i=O(n);return new Promise(function(j,l){var v=w.default.ajax({contentType:"application/json; charset=utf-8",url:a,dataType:"json",data:i});var g=v.xhr;function b(){g.abort();o=true;d();l({type:2,typeName:"ABORT",errorCode:"abort",errorMessage:g.statusText||"abort"})}function d(){if(r.signal){r.signal.removeEventListener("abort",b)}}if(r.signal){r.signal.addEventListener("abort",b)}v.then(function(t){o=false;d();var c=t.response;if(c.success){j(c.result)}else{l(c.error)}},function(t){if(!o){p.default.error(f,e,t.status);OK.Tracer.error(new Error("".concat(t.status," error in endpoint=").concat(e," with message=").concat(t.statusText)))}d();o=true;l({type:200,typeName:"SERVER_ERROR",errorCode:f,errorMessage:t.statusText||f})})})}var u={invoke:function invoke(e,n,r){var a={id:R()};r=r||{};var i=r.filter;if(n!==void 0&&n!==null){a.parameters=n}if(i!==void 0&&i!==null){a.filter=i}return A(e,a,r)}};if(typeof window!=="undefined"){window.webapi=u}var N=u.invoke.bind(u);s.default=u;s.invoke=N;Object.defineProperty(s,"__esModule",{value:true});return s});